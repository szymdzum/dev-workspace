{
  "$id": "file://.claude/schemas/hooks-manifest.schema.json",
  "title": "Claude Code Hooks Manifest Schema",
  "description": "Schema for Claude Code hooks manifest configuration",
  "type": "object",
  
  "properties": {
    "$schema": {
      "type": "string",
      "description": "Reference to this schema file"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version of the manifest"
    },
    "description": {
      "type": "string",
      "description": "Human-readable description of this manifest"
    },
    "env": {
      "type": "object",
      "description": "Environment variables for hook execution",
      "patternProperties": {
        "^[A-Z][A-Z0-9_]*$": {
          "type": "string"
        }
      }
    },
    "presets": {
      "type": "object",
      "description": "Named hook configurations",
      "patternProperties": {
        "^[a-z][a-z0-9-]*$": {
          "$ref": "#/$defs/preset"
        }
      }
    },
    "active": {
      "type": "string",
      "description": "Currently active preset name"
    },
    "hooks": {
      "$ref": "#/$defs/hookConfiguration",
      "description": "Active hook configuration"
    }
  },
  
  "required": ["version", "presets", "active"],
  
  "$defs": {
    "preset": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string"
        },
        "hooks": {
          "$ref": "#/$defs/hookConfiguration"
        }
      },
      "required": ["description", "hooks"]
    },
    
    "hookConfiguration": {
      "type": "object",
      "properties": {
        "PreToolUse": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/hookMatcher"
          }
        },
        "PostToolUse": {
          "type": "array", 
          "items": {
            "$ref": "#/$defs/hookMatcher"
          }
        }
      }
    },
    
    "hookMatcher": {
      "type": "object",
      "properties": {
        "matcher": {
          "type": "string",
          "description": "Pattern to match tool names (regex or glob)"
        },
        "hooks": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/hookDefinition"
          }
        }
      },
      "required": ["matcher", "hooks"]
    },
    
    "hookDefinition": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["command", "script"],
          "description": "Type of hook execution"
        },
        "command": {
          "type": "string",
          "description": "Command or script path to execute"
        },
        "timeout": {
          "type": "integer",
          "minimum": 1,
          "maximum": 300,
          "description": "Timeout in seconds"
        },
        "continueOnFailure": {
          "type": "boolean",
          "description": "Whether to continue if hook fails"
        },
        "env": {
          "type": "object",
          "description": "Environment variables for this hook",
          "patternProperties": {
            "^[A-Z][A-Z0-9_]*$": {
              "type": "string"
            }
          }
        }
      },
      "required": ["type", "command"]
    }
  }
}